<div class="modal-dialog" role="document">
    <div class="modal-content">
        <div class="modal-header">
            <h3 class="modal-title">Report Details</h3>
            <button type="button" class="close" data-dismiss="modal">
                <span aria-hidden="true">&times;</span>
            </button>
        </div>
        <div class="modal-body">
            <div *ngFor="let parameter of query?.parameters['parameterMap'] | keyvalue | displayOrder" class="pb-2 position-relative">
                <ng-container [ngSwitch]="parameter.value.type">
                    <div *ngSwitchCase="'CONCEPT'">
                        <label class="w-100 m-0" for="{{parameter.key}}">{{parameter.key}} <span *ngIf="parameter.value.mandatory" class="font-italic">(mandatory field)</span></label>
                        <input class="w-100 rounded input-border px-1" id="{{parameter.key}}" [(ngModel)]="parameter.value.value" (keyup)="searchTerm = parameter.value.value">
                        <app-snomed-typeahead *ngIf="parameter.value.value && !parameter.value.value.includes('|')" [searchTerm]="searchTerm" (selectEmitter)="parameter.value.value = convertConceptObjectToString($event)"></app-snomed-typeahead>
                    </div>
                    <div *ngSwitchCase="'BOOLEAN'">
                        <label class="m-0" for="{{parameter.key}}">{{parameter.key}} <span *ngIf="parameter.value.mandatory" class="font-italic">(mandatory field)</span></label>
                        <div class="w-100">
                            <mat-checkbox id="{{parameter.key}}" name="{{parameter.key}}" [(ngModel)]="parameter.value.value" class="pl-2"></mat-checkbox>
                        </div>
                    </div>
                    <div *ngSwitchCase="'STRING'">
                        <label class="w-100 m-0" for="{{parameter.key}}">{{parameter.key}} <span *ngIf="parameter.value.mandatory" class="font-italic">(mandatory field)</span></label>
                        <input id="{{parameter.key}}" name="{{parameter.key}}" class="w-100 rounded input-border px-1" [(ngModel)]="parameter.value.value">
                    </div>
                    <div *ngSwitchCase="'CONCEPT_LIST'">
                        <label class="w-100 m-0" for="{{parameter.key}}">{{parameter.key}} <span *ngIf="parameter.value.mandatory" class="font-italic">(mandatory field)</span></label>
                        <textarea #textareaTypeahead class="w-100 rounded input-border px-1" id="{{parameter.key}}" [(ngModel)]="parameter.value.value" (keyup)="searchTerm = parameter.value.value"></textarea>
                        <app-snomed-typeahead-list [searchTerm]="searchTerm" (selectEmitter)="parameter.value.value = appendConcept(parameter.value.value, convertConceptObjectToString($event))"></app-snomed-typeahead-list>
                        <div class="note font-italic">Multiple hierarchies can be entered via comma separation</div>
                    </div>
                    <div *ngSwitchCase="'TEMPLATE_NAME'">
                        <label class="w-100 m-0" for="{{parameter.key}}">{{parameter.key}} <span *ngIf="parameter.value.mandatory" class="font-italic">(mandatory field)</span></label>
                        <select id="{{parameter.key}}" class="form-control" [(ngModel)]="parameter.value.value">
                            <option selected></option>
                            <option *ngFor="let template of templates | orderBy:'name'">{{template.name}}</option>
                        </select>
                    </div>
                    <div *ngSwitchCase="'TEMPLATE'">
                        <label class="w-100 m-0" for="{{parameter.key}}">{{parameter.key}} <span *ngIf="parameter.value.mandatory" class="font-italic">(mandatory field)</span></label>
                        <textarea class="w-100 rounded input-border px-1" id="{{parameter.key}}" [(ngModel)]="parameter.value.value"></textarea>
                    </div>
                    <div *ngSwitchCase="'ECL'">
                        <label class="w-100 m-0" for="{{parameter.key}}">{{parameter.key}} <span *ngIf="parameter.value.mandatory" class="font-italic">(mandatory field)</span></label>
                        <textarea class="w-100 rounded input-border px-1" id="{{parameter.key}}" [(ngModel)]="parameter.value.value"></textarea>
                    </div>
                    <div *ngSwitchCase="'PROJECT'">
                        <label class="w-100 m-0" for="{{parameter.key}}">{{parameter.key}} <span *ngIf="parameter.value.mandatory" class="font-italic">(mandatory field)</span></label>
                        <select id="{{parameter.key}}" class="form-control" [(ngModel)]="parameter.value.value">
                            <option selected></option>
                            <option *ngFor="let project of projects | orderBy:'title'">{{project.title}}</option>
                        </select>
                    </div>
                    <div *ngSwitchCase="'HIDDEN'"></div>
                    <div *ngSwitchDefault>
                        <label class="w-100 m-0" for="{{parameter.key}}">{{parameter.key}}</label>
                        <input id="{{parameter.key}}" name="{{parameter.key}}" class="w-100 rounded input-border px-1" [(ngModel)]="parameter.value.value">
                    </div>
                </ng-container>
            </div>
        </div>
        <div class="modal-footer">
            <button type="button" class="btn btn-primary" (click)="submitReportRequest()" data-dismiss="modal">Run Query</button>
        </div>
    </div>
</div>
